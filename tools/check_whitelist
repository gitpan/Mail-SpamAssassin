#!/usr/bin/perl
use warnings ;
use strict ;
use Fcntl;
use AnyDBM_File ;
use vars qw( %h $k $v ) ;

my $db = $ENV{HOME}."/.spamassassin/auto-whitelist";	# is this right?

if (-f "$db.db") {
  tie %h, "AnyDBM_File",$db, O_RDWR|O_CREAT|O_EXCL,0600
      or die "Cannot open file $db: $!\n";
  my @k = grep(!/totscore$/,keys(%h));
  for my $key (@k)
  {
	my $t = $h{"$key|totscore"};
	my $v = $h{$key};
	if(defined($t)) { printf "%-40.40s -> % 2.1f %s\n",$key,$t/$v,"($t/$v)"; };
  }
  untie %h;
}
