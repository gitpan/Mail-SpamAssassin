
CC = @CC@
CFLAGS = @CFLAGS@
CCDLFLAGS = @CCDLFLAGS@

LIBS = @LIBS@
LDFLAGS = @LDFLAGS@
LDDLFLAGS = @LDDLFLAGS@

EXE_EXT = @EXEEXT@
SHLIBEXT = .so

SSLCFLAGS = -DSPAMC_SSL

SPAMC_FILES = spamd/spamc.c

QMAIL_SPAMC_FILES = qmail/qmail-spamc.c

LIBSPAMC_FILES = spamd/libspamc.c spamd/utils.c

all: spamd/spamc$(EXE_EXT) qmail/qmail-spamc
	true

libspamc: spamd/libspamc$(SHLIBEXT)
	true

spamd/spamc$(EXE_EXT): $(SPAMC_FILES) $(LIBSPAMC_FILES)
	$(CC) $(CFLAGS) $(SPAMC_FILES) $(LIBSPAMC_FILES) \
		-o $@ $(LDFLAGS) $(LIBS)

spamd/libspamc$(SHLIBEXT): $(LIBSPAMC_FILES)
	$(CC) $(CCDLFLAGS) $(LIBSPAMC_FILES) -o $@ $(LDDLFLAGS) $(LIBS)

spamd/sslspamc$(EXE_EXT): $(SPAMC_FILES) $(LIBSPAMC_FILES)
	$(CC) $(SSLCFLAGS) $(CFLAGS) $(SPAMC_FILES) $(LIBSPAMC_FILES) \
		-o $@ $(LDFLAGS) $(LIBS)

spamd/libsslspamc$(SHLIBEXT): $(LIBSPAMC_FILES)
	$(CC) $(SSLCFLAGS) $(CCDLFLAGS) $(LIBSPAMC_FILES) \
		-o $@ $(LDDLFLAGS) $(LIBS)

qmail/qmail-spamc: $(QMAIL_SPAMC_FILES)
	$(CC) $(CFLAGS) $(QMAIL_SPAMC_FILES) \
		-o $@ $(LDFLAGS) $(LIBS)

